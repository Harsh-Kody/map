<div class="container-fluid py-4 stream-dashboard">
  <!-- Filter + Actions -->
  <div class="row g-3 align-items-end mb-4">
    <!-- Filter dropdown -->
    <div class="col-lg-4 col-md-6">
      <label for="filterSelect" class="form-label fw-semibold"
        >Filter by Type</label
      >
      <ng-select
        class="custom-ng-select"
        [items]="filterOptions"
        bindLabel="label"
        bindValue="value"
        [multiple]="true"
        placeholder="Select filters"
        [(ngModel)]="selectedFilters"
        (change)="onFilterChange()"
        [closeOnSelect]="false"
      >
      </ng-select>
    </div>

    <div class="col-lg-4 col-md-6 d-flex gap-2">
      <button
        class="btn btn-success btn-sm flex-fill action-btn"
        (click)="startStream()"
        [disabled]="!selectedFilters.length"
      >
        <i class="bi bi-play-fill me-1"></i> Start
      </button>
      <button
        class="btn btn-danger btn-sm flex-fill action-btn"
        (click)="endStream()"
        [disabled]="!selectedFilters.length"
      >
        <i class="bi bi-stop-fill me-1"></i> Stop
      </button>
    </div>
  </div>

  <!-- Data Cards -->
  @if (isStreamStarted) {
  <div class="row g-4">
    @for (filter of selectedFilters; track $index) { @if (latestData[filter]) {
    <div class="col-xl-4 col-lg-6 col-md-12">
      <div class="card shadow-sm data-card h-100">
        <div
          class="card-header d-flex justify-content-between align-items-center bg-light fw-semibold"
        >
          <span>{{ filter }}</span>
          <button
            class="btn btn-sm btn-outline-primary"
            [disabled]="copiedMessageId === filter"
            (mousedown)="copyToClipBoard($event, filter)"
          >
            <i class="bi bi-clipboard"></i>
            {{ copiedMessageId === filter ? copyButtonText : "Copy JSON" }}
          </button>
        </div>
        <div class="card-body">
          <pre class="json-box">{{ latestData[filter] | json }}</pre>
        </div>
      </div>
    </div>
    } @else {
    <div class="col-md-12">
      <div class="alert alert-warning text-center">
        <i class="bi bi-exclamation-circle"></i> No Data Found for
        <strong>{{ filter }}</strong>
      </div>
    </div>
    } }
  </div>
  }
</div>
